  [1m[35m (222.7ms)[0m  [1m[35mCREATE DATABASE "pgconcepts_development" ENCODING = 'unicode'[0m
  [1m[35m (168.5ms)[0m  [1m[35mCREATE DATABASE "pgconcepts_test" ENCODING = 'unicode'[0m
  [1m[35m (13.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (1.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2024-05-04 16:44:50.588330', '2024-05-04 16:44:50.588332') RETURNING "key"[0m
Migrating to CreateUsers (20240504164405)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateUsers (20240504164405)
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "email" character varying NOT NULL, "type" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240504164405') RETURNING "version"[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateUsers (20240504164405)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.8ms)[0m  [1m[35mDROP TABLE "users"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (0.6ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20240504164405'[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateUsers (20240504164405)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.8ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "email" character varying NOT NULL, "type" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240504164405') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateLocations (20240504164731)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "locations" ("id" bigserial primary key, "address" character varying NOT NULL, "latitude" decimal(15,10) NOT NULL, "longitude" decimal(15,10) NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE INDEX "index_locations_on_address" ON "locations" ("address")[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE INDEX "index_locations_on_latitude" ON "locations" ("latitude")[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE INDEX "index_locations_on_longitude" ON "locations" ("longitude")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240504164731') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateTripRequests (20240504164850)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.9ms)[0m  [1m[35mCREATE TABLE "trip_requests" ("id" bigserial primary key, "rider_id" integer NOT NULL, "start_location_id" integer NOT NULL, "end_location_id" integer NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE INDEX "index_trip_requests_on_rider_id" ON "trip_requests" ("rider_id")[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE INDEX "index_trip_requests_on_start_location_id" ON "trip_requests" ("start_location_id")[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE INDEX "index_trip_requests_on_end_location_id" ON "trip_requests" ("end_location_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240504164850') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateTrips (20240504164951)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE "trips" ("id" bigserial primary key, "trip_request_id" integer NOT NULL, "driver_id" integer NOT NULL, "completed_at" timestamp, "rating" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE INDEX "index_trips_on_trip_request_id" ON "trips" ("trip_request_id")[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE INDEX "index_trips_on_driver_id" ON "trips" ("driver_id")[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE INDEX "index_trips_on_rating" ON "trips" ("rating")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240504164951') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (2.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (3.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddEnumTypeToVehicles (20240505170859)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddEnumTypeToVehicles (20240505170859)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddEnumTypeToVehicles (20240505170859)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (25.5ms)[0m  [1m[35mDO $$
BEGIN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_type t
      JOIN pg_namespace n ON t.typnamespace = n.oid
      WHERE t.typname = 'vehicle_status'
        AND n.nspname = ANY (current_schemas(false))
    ) THEN
        CREATE TYPE "vehicle_status" AS ENUM ('draft', 'published');
    END IF;
END
$$;
[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "vehicles" ADD "status" vehicle_status DEFAULT 'draft' NOT NULL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddEnumTypeToVehicles (20240505170859)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (4.9ms)[0m  [1m[35mDO $$
BEGIN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_type t
      JOIN pg_namespace n ON t.typnamespace = n.oid
      WHERE t.typname = 'vehicle_status'
        AND n.nspname = ANY (current_schemas(false))
    ) THEN
        CREATE TYPE "vehicle_status" AS ENUM ('draft', 'published');
    END IF;
END
$$;
[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "vehicles" ADD "status" vehicle_status DEFAULT 'draft' NOT NULL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateVehicles (20240505174524)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (14.2ms)[0m  [1m[35mCREATE TABLE "vehicles" ("id" bigserial primary key, "name" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_vehicles_on_name" ON "vehicles" ("name")[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240505174524') RETURNING "version"[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddStatusToVehicles (20240505174610)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "vehicles" ADD "status" character varying DEFAULT 'draft' NOT NULL[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240505174610') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddEnumTypeToVehicles (20240505170859)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (4.0ms)[0m  [1m[35mDO $$
BEGIN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_type t
      JOIN pg_namespace n ON t.typnamespace = n.oid
      WHERE t.typname = 'vehicle_status'
        AND n.nspname = ANY (current_schemas(false))
    ) THEN
        CREATE TYPE "vehicle_status" AS ENUM ('draft', 'published');
    END IF;
END
$$;
[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "vehicles" ADD "status" vehicle_status DEFAULT 'draft' NOT NULL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddEnumTypeToVehicles (20240505174714)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (2.0ms)[0m  [1m[35mDO $$
BEGIN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_type t
      JOIN pg_namespace n ON t.typnamespace = n.oid
      WHERE t.typname = 'vehicle_status'
        AND n.nspname = ANY (current_schemas(false))
    ) THEN
        CREATE TYPE "vehicle_status" AS ENUM ('draft', 'published');
    END IF;
END
$$;
[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "vehicles" ADD "status" vehicle_status DEFAULT 'draft' NOT NULL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddStatusToVehicles (20240505174610)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.2ms)[0m  [1m[35mALTER TABLE "vehicles" DROP COLUMN "status"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (0.3ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20240505174610'[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddEnumTypeToVehicles (20240505174714)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35mSQL (3.1ms)[0m  [1m[35mDO $$
BEGIN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_type t
      JOIN pg_namespace n ON t.typnamespace = n.oid
      WHERE t.typname = 'vehicle_status'
        AND n.nspname = ANY (current_schemas(false))
    ) THEN
        CREATE TYPE "vehicle_status" AS ENUM ('draft', 'published');
    END IF;
END
$$;
[0m
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "vehicles" ADD "status" vehicle_status DEFAULT 'draft' NOT NULL[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240505174714') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreatePgheroQueryStats (20240505192145)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "pghero_query_stats" ("id" bigserial primary key, "database" text, "user" text, "query" text, "query_hash" bigint, "total_time" float, "calls" bigint, "captured_at" timestamp)[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE INDEX "index_pghero_query_stats_on_database_and_captured_at" ON "pghero_query_stats" ("database", "captured_at")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240505192145') RETURNING "version"[0m
  [1m[36mTRANSACTION (13.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT current_database() /*pghero*/[0m
  [1m[35m (2.5ms)[0m  [1m[34mSELECT * FROM pg_stat_statements LIMIT 1 /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW server_version_num /*pghero*/[0m
  [1m[35m (4.4ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = 'pgconcepts_development' ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 1000000 /*pghero*/[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT oid FROM pg_database WHERE datname = 'pgconcepts_development' /*pghero*/[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT pg_stat_statements_reset(0, 30073, 0) /*pghero*/[0m
  [1m[36mPgHero::QueryStats Bulk Insert (3.5ms)[0m  [1m[32mINSERT INTO "pghero_query_stats" ("database","query","total_time","calls","captured_at","query_hash","user") VALUES ('primary', 'CREATE DATABASE exp', 207.998987, 1, '2024-05-05 19:21:57.091002', -5285096120304467998, 'elaraby'), ('primary', 'SELECT a.attname
  FROM (
         SELECT indrelid, indkey, generate_subscripts(indkey, $1) idx
           FROM pg_index
          WHERE indrelid = $2::regclass
            AND indisprimary
       ) i
  JOIN pg_attribute a
    ON a.attrelid = i.indrelid
   AND a.attnum = i.indkey[i.idx]
 ORDER BY i.idx', 44.000208, 75, '2024-05-05 19:21:57.091002', 8461907948340582648, 'elaraby'), ('primary', 'SELECT a.attname, format_type(a.atttypid, a.atttypmod),
       pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod,
       c.collname, col_description(a.attrelid, a.attnum) AS comment,
       attidentity AS identity,
       attgenerated as attgenerated
  FROM pg_attribute a
  LEFT JOIN pg_attrdef d ON a.attrelid = d.adrelid AND a.attnum = d.adnum
  LEFT JOIN pg_type t ON a.atttypid = t.oid
  LEFT JOIN pg_collation c ON a.attcollation = c.oid AND a.attcollation <> t.typcollation
 WHERE a.attrelid = $1::regclass
   AND a.attnum > $2 AND NOT a.attisdropped
 ORDER BY a.attnum', 33.03780999999999, 82, '2024-05-05 19:21:57.091002', 4915973709338507323, 'elaraby'), ('primary', 'DO $$
BEGIN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_type t
      JOIN pg_namespace n ON t.typnamespace = n.oid
      WHERE t.typname = ''vehicle_status''
        AND n.nspname = ANY (current_schemas(false))
    ) THEN
        CREATE TYPE "vehicle_status" AS ENUM (''draft'', ''published'');
    END IF;
END
$$', 25.138748999999997, 5, '2024-05-05 19:21:57.091002', 8311043889716639937, 'elaraby'), ('primary', 'SELECT t.oid, t.typname, t.typelem, t.typdelim, t.typinput, r.rngsubtype, t.typtype, t.typbasetype
FROM pg_type as t
LEFT JOIN pg_range as r ON oid = rngtypid
WHERE
  t.typname IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40)', 17.253851000000004, 27, '2024-05-05 19:21:57.091002', -1273046326328391408, 'elaraby'), ('primary', 'SELECT distinct i.relname, d.indisunique, d.indkey, pg_get_indexdef(d.indexrelid), t.oid,
                pg_catalog.obj_description(i.oid, $1) AS comment, d.indisvalid
FROM pg_class t
INNER JOIN pg_index d ON t.oid = d.indrelid
INNER JOIN pg_class i ON d.indexrelid = i.oid
LEFT JOIN pg_namespace n ON n.oid = t.relnamespace
WHERE i.relkind IN ($2, $3)
  AND d.indisprimary = $4
  AND t.relname = $5
  AND n.nspname = ANY (current_schemas($6))
ORDER BY i.relname', 16.883229, 73, '2024-05-05 19:21:57.091002', -8010191803973996901, 'elaraby'), ('primary', 'CREATE EXTENSION pg_stat_statements', 16.373927, 1, '2024-05-05 19:21:57.091002', 2643756286501377769, 'elaraby'), ('primary', 'CREATE TABLE "vehicles" ("id" bigserial primary key, "name" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)', 14.052002, 1, '2024-05-05 19:21:57.091002', 8242577692756941884, 'elaraby'), ('primary', 'CREATE TYPE "vehicle_status" AS ENUM (''draft'', ''published'')', 13.644609, 5, '2024-05-05 19:21:57.091002', 7214509233598807065, 'elaraby'), ('primary', 'CREATE TABLE "users" ("id" bigserial primary key, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "email" character varying NOT NULL, "type" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)', 11.826467000000001, 2, '2024-05-05 19:21:57.091002', -265866807940122877, 'elaraby'), ('primary', 'CREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)', 11.065087, 1, '2024-05-05 19:21:57.091002', -7942292038776270537, 'elaraby'), ('primary', 'CREATE TABLE "pghero_query_stats" ("id" bigserial primary key, "database" text, "user" text, "query" text, "query_hash" bigint, "total_time" float, "calls" bigint, "captured_at" timestamp)', 9.987597, 1, '2024-05-05 19:21:57.091002', -6671619827919097734, 'elaraby'), ('primary', 'CREATE TABLE "trips" ("id" bigserial primary key, "trip_request_id" integer NOT NULL, "driver_id" integer NOT NULL, "completed_at" timestamp, "rating" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)', 7.779555000000001, 1, '2024-05-05 19:21:57.091002', 7072710019794348229, 'elaraby'), ('primary', 'CREATE TABLE "locations" ("id" bigserial primary key, "address" character varying NOT NULL, "latitude" decimal(15,10) NOT NULL, "longitude" decimal(15,10) NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)', 6.551967, 1, '2024-05-05 19:21:57.091002', -3852365702325496719, 'elaraby'), ('primary', 'CREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)', 5.568229, 1, '2024-05-05 19:21:57.091002', -1843915230226581209, 'elaraby'), ('primary', 'SELECT t.oid, t.typname
FROM pg_type as t
WHERE t.typname IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)', 3.9000679999999996, 22, '2024-05-05 19:21:57.091002', 7017045154089069860, 'elaraby'), ('primary', 'SELECT pg_catalog.obj_description(c.oid, $1)
FROM pg_catalog.pg_class c
  LEFT JOIN pg_namespace n ON n.oid = c.relnamespace
WHERE c.relname = $2
  AND c.relkind IN ($3,$4)
  AND n.nspname = ANY (current_schemas($5))', 3.585382, 32, '2024-05-05 19:21:57.091002', 4048411654557509007, 'elaraby'), ('primary', 'SELECT t.oid, t.typname, t.typelem, t.typdelim, t.typinput, r.rngsubtype, t.typtype, t.typbasetype
FROM pg_type as t
LEFT JOIN pg_range as r ON oid = rngtypid
WHERE
  t.typtype IN ($1, $2, $3)', 3.412674, 27, '2024-05-05 19:21:57.091002', 4475989727516172594, 'elaraby'), ('primary', 'DROP TABLE "users"', 3.166375, 1, '2024-05-05 19:21:57.091002', -4421924850513971994, 'elaraby'), ('primary', 'SET SESSION timezone TO ''UTC''', 2.9324719999999997, 22, '2024-05-05 19:21:57.091002', 5837330887461066009, 'elaraby'), ('primary', 'CREATE TABLE "trip_requests" ("id" bigserial primary key, "rider_id" integer NOT NULL, "start_location_id" integer NOT NULL, "end_location_id" integer NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)', 2.774235, 1, '2024-05-05 19:21:57.091002', 7035137553564415059, 'elaraby'), ('primary', 'SELECT t.oid, t.typname, t.typelem, t.typdelim, t.typinput, r.rngsubtype, t.typtype, t.typbasetype
FROM pg_type as t
LEFT JOIN pg_range as r ON oid = rngtypid
WHERE
  t.typelem IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48)', 2.3195230000000002, 17, '2024-05-05 19:21:57.091002', -1091333886213131546, 'elaraby'), ('primary', 'NOT EXISTS (
      SELECT $1
      FROM pg_type t
      JOIN pg_namespace n ON t.typnamespace = n.oid
      WHERE t.typname = $2
        AND n.nspname = ANY (current_schemas($3))
    )', 2.2224540000000004, 5, '2024-05-05 19:21:57.091002', -2924857401756576364, 'elaraby'), ('primary', 'CREATE INDEX "index_locations_on_address" ON "locations" ("address")', 2.050171, 1, '2024-05-05 19:21:57.091002', 7288689199682563735, 'elaraby'), ('primary', 'CREATE INDEX "index_pghero_query_stats_on_database_and_captured_at" ON "pghero_query_stats" ("database", "captured_at")', 1.9226169999999998, 1, '2024-05-05 19:21:57.091002', -867500661418085158, 'elaraby'), ('primary', 'CREATE UNIQUE INDEX "index_vehicles_on_name" ON "vehicles" ("name")', 1.8696539999999997, 1, '2024-05-05 19:21:57.091002', 1821373753161018949, 'elaraby'), ('primary', 'CREATE INDEX "index_locations_on_longitude" ON "locations" ("longitude")', 1.847797, 1, '2024-05-05 19:21:57.091002', 2794720112273253829, 'elaraby'), ('primary', 'CREATE INDEX "index_locations_on_latitude" ON "locations" ("latitude")', 1.783458, 1, '2024-05-05 19:21:57.091002', 3706989620150825556, 'elaraby'), ('primary', 'CREATE VIEW pg_stat_statements AS
  SELECT * FROM pg_stat_statements(true)', 1.7064629999999998, 2, '2024-05-05 19:21:57.091002', 7101910292398537824, 'elaraby'), ('primary', 'CREATE INDEX "index_trips_on_driver_id" ON "trips" ("driver_id")', 1.689579, 1, '2024-05-05 19:21:57.091002', 9117067341399456678, 'elaraby'), ('primary', 'CREATE INDEX "index_trip_requests_on_rider_id" ON "trip_requests" ("rider_id")', 1.657979, 1, '2024-05-05 19:21:57.091002', 3645427364078824488, 'elaraby'), ('primary', 'CREATE INDEX "index_trip_requests_on_start_location_id" ON "trip_requests" ("start_location_id")', 1.616241, 1, '2024-05-05 19:21:57.091002', 9167139981735216107, 'elaraby'), ('primary', 'CREATE INDEX "index_trips_on_trip_request_id" ON "trips" ("trip_request_id")', 1.600544, 1, '2024-05-05 19:21:57.091002', -3787218010171532982, 'elaraby'), ('primary', 'CREATE INDEX "index_trip_requests_on_end_location_id" ON "trip_requests" ("end_location_id")', 1.587037, 1, '2024-05-05 19:21:57.091002', -623750421146732326, 'elaraby'), ('primary', 'CREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")', 1.468292, 1, '2024-05-05 19:21:57.091002', 799345961516330465, 'elaraby'), ('primary', 'CREATE INDEX "index_trips_on_rating" ON "trips" ("rating")', 1.453832, 1, '2024-05-05 19:21:57.091002', 1566047379041556159, 'elaraby'), ('primary', 'SELECT c.relname FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname = ANY (current_schemas($1)) AND c.relkind IN ($2,$3)', 1.4405109999999999, 18, '2024-05-05 19:21:57.091002', -2711388012115186664, 'elaraby'), ('primary', 'ALTER TABLE "vehicles" DROP COLUMN "status"', 1.438406, 1, '2024-05-05 19:21:57.091002', -1931563575341544719, 'elaraby'), ('primary', '-- Register a view on the function for ease of use.
CREATE VIEW pg_stat_statements AS
  SELECT * FROM pg_stat_statements(true)', 1.427423, 1, '2024-05-05 19:21:57.091002', 5647889157396938542, 'elaraby'), ('primary', 'SELECT c.conname, c.conrelid, c.conkey, c.condeferrable, c.condeferred
FROM pg_constraint c
JOIN pg_class t ON c.conrelid = t.oid
JOIN pg_namespace n ON n.oid = c.connamespace
WHERE c.contype = $1
  AND t.relname = $2
  AND n.nspname = ANY (current_schemas($3))', 1.3768690000000006, 63, '2024-05-05 19:21:57.091002', -4824365133879625359, 'elaraby'), ('primary', 'SELECT t.oid, t.typname, t.typelem, t.typdelim, t.typinput, r.rngsubtype, t.typtype, t.typbasetype
FROM pg_type as t
LEFT JOIN pg_range as r ON oid = rngtypid
WHERE
  t.typelem IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49)', 1.303944, 10, '2024-05-05 19:21:57.091002', -1532725852482527838, 'elaraby'), ('primary', 'INSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"', 1.288581, 9, '2024-05-05 19:21:57.091002', 7941103273415005410, 'elaraby'), ('primary', 'ALTER TABLE "vehicles" ADD "status" vehicle_status DEFAULT ''draft'' NOT NULL', 1.242889, 1, '2024-05-05 19:21:57.091002', 7953024278174142312, 'elaraby'), ('primary', 'SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete, c.convalidated AS valid, c.condeferrable AS deferrable, c.condeferred AS deferred, c.conkey, c.confkey, c.conrelid, c.confrelid
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[$1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[$2] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = $3
  AND t1.relname = $4
  AND t3.nspname = ANY (current_schemas($5))
ORDER BY c.conname', 1.070967, 68, '2024-05-05 19:21:57.091002', 2192050985754420727, 'elaraby'), ('primary', 'SELECT a.attnum, a.attname
FROM pg_attribute a
WHERE a.attrelid = $1
AND a.attnum IN ($2)', 0.9237940000000002, 147, '2024-05-05 19:21:57.091002', 4550238082187510292, 'elaraby'), ('primary', 'SELECT * FROM pg_stat_statements LIMIT $1 /*pghero*/', 0.844533, 1, '2024-05-05 19:21:57.091002', -3783095795909098367, 'elaraby'), ('primary', 'SELECT conname, pg_get_constraintdef(c.oid) AS constraintdef, c.condeferrable, c.condeferred
            FROM pg_constraint c
            JOIN pg_class t ON c.conrelid = t.oid
            JOIN pg_namespace n ON n.oid = c.connamespace
            WHERE c.contype = $1
              AND t.relname = $2
              AND n.nspname = ANY (current_schemas($3))', 0.812819, 63, '2024-05-05 19:21:57.091002', -6500871677987628833, 'elaraby'), ('primary', 'ALTER TABLE "vehicles" ADD "status" character varying DEFAULT ''draft'' NOT NULL', 0.804958, 1, '2024-05-05 19:21:57.091002', -7848350691923910166, 'elaraby'), ('primary', 'SELECT n.nspname as "Schema",
  c.relname as "Name",
  CASE c.relkind WHEN $1 THEN $2 WHEN $3 THEN $4 WHEN $5 THEN $6 WHEN $7 THEN $8 WHEN $9 THEN $10 WHEN $11 THEN $12 WHEN $13 THEN $14 WHEN $15 THEN $16 WHEN $17 THEN $18 END as "Type",
  pg_catalog.pg_get_userbyid(c.relowner) as "Owner"
FROM pg_catalog.pg_class c
     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
     LEFT JOIN pg_catalog.pg_am am ON am.oid = c.relam
WHERE c.relkind IN ($19,$20,$21,$22,$23,$24,$25)
      AND n.nspname <> $26
      AND n.nspname !~ $27
      AND n.nspname <> $28
  AND pg_catalog.pg_table_is_visible(c.oid)
ORDER BY 1,2', 0.708001, 1, '2024-05-05 19:21:57.091002', -5816723732655690671, 'elaraby'), ('primary', 'SELECT * FROM pg_stat_activity
WHERE pid = (SELECT * FROM PG_BACKEND_PID())', 0.583983, 3, '2024-05-05 19:21:57.091002', -5318824898862544737, 'elaraby'), ('primary', 'SELECT conname, pg_get_constraintdef(c.oid, $1) AS constraintdef, c.convalidated AS valid
            FROM pg_constraint c
            JOIN pg_class t ON c.conrelid = t.oid
            JOIN pg_namespace n ON n.oid = c.connamespace
            WHERE c.contype = $2
              AND t.relname = $3
              AND n.nspname = ANY (current_schemas($4))', 0.5521410000000002, 34, '2024-05-05 19:21:57.091002', -6621698902663167593, 'elaraby'), ('primary', 'SELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC', 0.5511589999999998, 33, '2024-05-05 19:21:57.091002', -6957508824942958225, 'elaraby'), ('primary', 'GRANT SELECT ON pg_stat_statements TO PUBLIC', 0.434931, 3, '2024-05-05 19:21:57.091002', -8092650902402444792, 'elaraby'), ('primary', 'SELECT extname FROM pg_extension', 0.42604600000000004, 10, '2024-05-05 19:21:57.091002', -7877193146414612934, 'elaraby'), ('primary', '/* contrib/pg_stat_statements/pg_stat_statements--1.4.sql */

-- complain if script is sourced in psql, rather than via CREATE EXTENSION


-- Register functions.
CREATE FUNCTION pg_stat_statements_reset()
RETURNS void
AS ''$libdir/pg_stat_statements''
LANGUAGE C PARALLEL SAFE', 0.425263, 1, '2024-05-05 19:21:57.091002', -6737802796196108371, 'elaraby'), ('primary', 'CREATE VIEW pg_stat_statements_info AS
  SELECT * FROM pg_stat_statements_info()', 0.403032, 1, '2024-05-05 19:21:57.091002', -765267056411509909, 'elaraby'), ('primary', 'SELECT c.relname FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname = ANY (current_schemas($1)) AND c.relname = $2 AND c.relkind IN ($3,$4)', 0.40264400000000006, 38, '2024-05-05 19:21:57.091002', -7642143403782554761, 'elaraby'), ('primary', 'SELECT
  type.typname AS name,
  type.OID AS oid,
  n.nspname AS schema,
  string_agg(enum.enumlabel, $1 ORDER BY enum.enumsortorder) AS value
FROM pg_enum AS enum
JOIN pg_type AS type ON (type.oid = enum.enumtypid)
JOIN pg_namespace n ON type.typnamespace = n.oid
WHERE n.nspname = ANY (current_schemas($2))
GROUP BY type.OID, n.nspname, type.typname', 0.39282200000000006, 10, '2024-05-05 19:21:57.091002', -2816343317766512996, 'elaraby'), ('primary', '/* Then we can drop them */
DROP VIEW pg_stat_statements', 0.39170099999999997, 2, '2024-05-05 19:21:57.091002', 5332373096099443151, 'elaraby'), ('primary', 'SELECT c.relname FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname = ANY (current_schemas($1)) AND c.relname = $2 AND c.relkind IN ($3,$4,$5,$6,$7)', 0.35953599999999997, 32, '2024-05-05 19:21:57.091002', 8944653168481220391, 'elaraby'), ('primary', 'SELECT c.relname FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname = ANY (current_schemas($1)) AND c.relkind IN ($2,$3,$4,$5,$6)', 0.35280700000000004, 4, '2024-05-05 19:21:57.091002', 645989269295862577, 'elaraby'), ('primary', 'INSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"', 0.274467, 1, '2024-05-05 19:21:57.091002', 7676242454395981166, 'elaraby'), ('primary', 'SELECT nspname
  FROM pg_namespace
 WHERE nspname !~ $1
   AND nspname NOT IN ($2)
 ORDER by nspname', 0.26395500000000005, 10, '2024-05-05 19:21:57.091002', -6396947832378194637, 'elaraby'), ('primary', '/* Now redefine */
CREATE FUNCTION pg_stat_statements(IN showtext boolean,
    OUT userid oid,
    OUT dbid oid,
    OUT toplevel bool,
    OUT queryid bigint,
    OUT query text,
    OUT plans int8,
    OUT total_plan_time float8,
    OUT min_plan_time float8,
    OUT max_plan_time float8,
    OUT mean_plan_time float8,
    OUT stddev_plan_time float8,
    OUT calls int8,
    OUT total_exec_time float8,
    OUT min_exec_time float8,
    OUT max_exec_time float8,
    OUT mean_exec_time float8,
    OUT stddev_exec_time float8,
    OUT rows int8,
    OUT shared_blks_hit int8,
    OUT shared_blks_read int8,
    OUT shared_blks_dirtied int8,
    OUT shared_blks_written int8,
    OUT local_blks_hit int8,
    OUT local_blks_read int8,
    OUT local_blks_dirtied int8,
    OUT local_blks_written int8,
    OUT temp_blks_read int8,
    OUT temp_blks_written int8,
    OUT blk_read_time float8,
    OUT blk_write_time float8,
    OUT wal_records int8,
    OUT wal_fpi int8,
    OUT wal_bytes numeric
)
RETURNS SETOF record
AS ''$libdir/pg_stat_statements'', ''pg_stat_statements_1_9''
LANGUAGE C STRICT VOLATILE PARALLEL SAFE', 0.237483, 1, '2024-05-05 19:21:57.091002', -535599571461129876, 'elaraby'), ('primary', 'SELECT
  d.datname as "Name",
  pg_catalog.pg_get_userbyid(d.datdba) as "Owner",
  pg_catalog.pg_encoding_to_char(d.encoding) as "Encoding",
  $1 AS "Locale Provider",
  d.datcollate as "Collate",
  d.datctype as "Ctype",
  $2 as "ICU Locale",
  $3 as "ICU Rules",
  pg_catalog.array_to_string(d.datacl, $4) AS "Access privileges"
FROM pg_catalog.pg_database d
ORDER BY 1', 0.22202, 3, '2024-05-05 19:21:57.091002', 362055932830268171, 'elaraby'), ('primary', 'SELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT $2', 0.219101, 15, '2024-05-05 19:21:57.091002', -3605377712848817883, 'elaraby'), ('primary', 'set client_encoding to ''unicode''', 0.21880000000000002, 22, '2024-05-05 19:21:57.091002', 7490503619681577402, 'elaraby'), ('primary', 'SELECT c.relname, $1::pg_catalog.text FROM pg_catalog.pg_class c WHERE c.relkind IN ($2, $3, $4, $5, $6, $7) AND (c.relname) LIKE $8 AND pg_catalog.pg_table_is_visible(c.oid) AND c.relnamespace <> (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = $9)
UNION ALL
SELECT $10::pg_catalog.text, n.nspname FROM pg_catalog.pg_namespace n WHERE n.nspname LIKE $11 AND n.nspname NOT LIKE $12
LIMIT $13', 0.207456, 3, '2024-05-05 19:21:57.091002', -2407823360804191893, 'elaraby'), ('primary', 'CREATE FUNCTION pg_stat_statements(IN showtext boolean,
    OUT userid oid,
    OUT dbid oid,
    OUT queryid bigint,
    OUT query text,
    OUT calls int8,
    OUT total_time float8,
    OUT min_time float8,
    OUT max_time float8,
    OUT mean_time float8,
    OUT stddev_time float8,
    OUT rows int8,
    OUT shared_blks_hit int8,
    OUT shared_blks_read int8,
    OUT shared_blks_dirtied int8,
    OUT shared_blks_written int8,
    OUT local_blks_hit int8,
    OUT local_blks_read int8,
    OUT local_blks_dirtied int8,
    OUT local_blks_written int8,
    OUT temp_blks_read int8,
    OUT temp_blks_written int8,
    OUT blk_read_time float8,
    OUT blk_write_time float8
)
RETURNS SETOF record
AS ''$libdir/pg_stat_statements'', ''pg_stat_statements_1_3''
LANGUAGE C STRICT VOLATILE PARALLEL SAFE', 0.17157, 1, '2024-05-05 19:21:57.091002', 9219655088872814515, 'elaraby'), ('primary', 'SELECT current_database()', 0.159841, 18, '2024-05-05 19:21:57.091002', -4019059735687853059, 'elaraby'), ('primary', 'SELECT
n.nspname AS enum_schema,
t.typname AS enum_name,
e.enumlabel AS enum_value
FROM pg_type t
JOIN pg_enum e ON t.oid = e.enumtypid
JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace', 0.158283, 1, '2024-05-05 19:21:57.091002', -531432016565285159, 'elaraby'), ('primary', '/* Now redefine */
CREATE FUNCTION pg_stat_statements_reset(IN userid Oid DEFAULT 0,
	IN dbid Oid DEFAULT 0,
	IN queryid bigint DEFAULT 0
)
RETURNS void
AS ''$libdir/pg_stat_statements'', ''pg_stat_statements_reset_1_7''
LANGUAGE C STRICT PARALLEL SAFE', 0.153457, 1, '2024-05-05 19:21:57.091002', 7360949727111689113, 'elaraby'), ('primary', '/* First we have to remove them from the extension */
ALTER EXTENSION pg_stat_statements DROP VIEW pg_stat_statements', 0.146293, 1, '2024-05-05 19:21:57.091002', -690231953034270333, 'elaraby'), ('primary', '/* contrib/pg_stat_statements/pg_stat_statements--1.7--1.8.sql */

-- complain if script is sourced in psql, rather than via ALTER EXTENSION


/* First we have to remove them from the extension */
ALTER EXTENSION pg_stat_statements DROP VIEW pg_stat_statements', 0.123921, 1, '2024-05-05 19:21:57.091002', -4315321953012072193, 'elaraby'), ('primary', '/* Now redefine */
CREATE FUNCTION pg_stat_statements(IN showtext boolean,
    OUT userid oid,
    OUT dbid oid,
    OUT queryid bigint,
    OUT query text,
    OUT plans int8,
    OUT total_plan_time float8,
    OUT min_plan_time float8,
    OUT max_plan_time float8,
    OUT mean_plan_time float8,
    OUT stddev_plan_time float8,
    OUT calls int8,
    OUT total_exec_time float8,
    OUT min_exec_time float8,
    OUT max_exec_time float8,
    OUT mean_exec_time float8,
    OUT stddev_exec_time float8,
    OUT rows int8,
    OUT shared_blks_hit int8,
    OUT shared_blks_read int8,
    OUT shared_blks_dirtied int8,
    OUT shared_blks_written int8,
    OUT local_blks_hit int8,
    OUT local_blks_read int8,
    OUT local_blks_dirtied int8,
    OUT local_blks_written int8,
    OUT temp_blks_read int8,
    OUT temp_blks_written int8,
    OUT blk_read_time float8,
    OUT blk_write_time float8,
    OUT wal_records int8,
    OUT wal_fpi int8,
    OUT wal_bytes numeric
)
RETURNS SETOF record
AS ''$libdir/pg_stat_statements'', ''pg_stat_statements_1_8''
LANGUAGE C STRICT VOLATILE PARALLEL SAFE', 0.11545499999999999, 1, '2024-05-05 19:21:57.091002', 1356024902385697363, 'elaraby'), ('primary', 'select * from pg_locks', 0.103697, 1, '2024-05-05 19:21:57.091002', 1866733301326765118, 'elaraby'), ('primary', '/* Then we can drop them */
DROP FUNCTION pg_stat_statements_reset()', 0.100578, 1, '2024-05-05 19:21:57.091002', -5005008434753111192, 'elaraby'), ('primary', '/* contrib/pg_stat_statements/pg_stat_statements--1.8--1.9.sql */

-- complain if script is sourced in psql, rather than via ALTER EXTENSION


--- Define pg_stat_statements_info
CREATE FUNCTION pg_stat_statements_info(
    OUT dealloc bigint,
    OUT stats_reset timestamp with time zone
)
RETURNS record
AS ''$libdir/pg_stat_statements''
LANGUAGE C STRICT VOLATILE PARALLEL SAFE', 0.095478, 1, '2024-05-05 19:21:57.091002', -6079059909818475879, 'elaraby'), ('primary', '/* contrib/pg_stat_statements/pg_stat_statements--1.4--1.5.sql */

-- complain if script is sourced in psql, rather than via ALTER EXTENSION


GRANT EXECUTE ON FUNCTION pg_stat_statements_reset() TO pg_read_all_stats', 0.089727, 1, '2024-05-05 19:21:57.091002', -3085278641555168774, 'elaraby'), ('primary', 'SELECT c.relname, $1::pg_catalog.text FROM pg_catalog.pg_class c WHERE c.relkind IN ($2, $3, $4, $5, $6, $7) AND (c.relname) LIKE $8 AND pg_catalog.pg_table_is_visible(c.oid)
UNION ALL
SELECT $9::pg_catalog.text, n.nspname FROM pg_catalog.pg_namespace n WHERE n.nspname LIKE $10
LIMIT $11', 0.08265499999999999, 2, '2024-05-05 19:21:57.091002', 8528957006195043562, 'elaraby'), ('primary', 'SELECT pg_advisory_unlock($1)', 0.069135, 17, '2024-05-05 19:21:57.091002', 3033895647379871167, 'elaraby'), ('primary', '/* contrib/pg_stat_statements/pg_stat_statements--1.5--1.6.sql */

-- complain if script is sourced in psql, rather than via ALTER EXTENSION


-- Execution is only allowed for superusers, fixing issue with 1.5.
REVOKE EXECUTE ON FUNCTION pg_stat_statements_reset() FROM pg_read_all_stats', 0.067716, 1, '2024-05-05 19:21:57.091002', -3232140260748463617, 'elaraby'), ('primary', 'GRANT SELECT ON pg_stat_statements_info TO PUBLIC', 0.056164, 1, '2024-05-05 19:21:57.091002', 1293503152993561188, 'elaraby'), ('primary', '-- Don''t want this to be available to non-superusers.
REVOKE ALL ON FUNCTION pg_stat_statements_reset(Oid, Oid, bigint) FROM PUBLIC', 0.055934, 1, '2024-05-05 19:21:57.091002', -2249120274633451873, 'elaraby'), ('primary', '-- Don''t want this to be available to non-superusers.
REVOKE ALL ON FUNCTION pg_stat_statements_reset() FROM PUBLIC', 0.055052, 1, '2024-05-05 19:21:57.091002', -3928201315673746786, 'elaraby'), ('primary', 'SELECT pg_try_advisory_lock($1)', 0.05074299999999999, 17, '2024-05-05 19:21:57.091002', -5512890310722621573, 'elaraby'), ('primary', 'SET client_min_messages TO ''warning''', 0.046779, 22, '2024-05-05 19:21:57.091002', 3951107970310169007, 'elaraby'), ('primary', 'DROP FUNCTION pg_stat_statements(boolean)', 0.046347, 2, '2024-05-05 19:21:57.091002', -1955052314674129380, 'elaraby'), ('primary', 'SET standard_conforming_strings = on', 0.04149599999999999, 22, '2024-05-05 19:21:57.091002', 7797107365549261724, 'elaraby'), ('primary', 'ALTER EXTENSION pg_stat_statements DROP FUNCTION pg_stat_statements(boolean)', 0.038552, 2, '2024-05-05 19:21:57.091002', -5792852134034941533, 'elaraby'), ('primary', '/* contrib/pg_stat_statements/pg_stat_statements--1.6--1.7.sql */

-- complain if script is sourced in psql, rather than via ALTER EXTENSION


/* First we have to remove them from the extension */
ALTER EXTENSION pg_stat_statements DROP FUNCTION pg_stat_statements_reset()', 0.037931, 1, '2024-05-05 19:21:57.091002', -3655516217747249099, 'elaraby'), ('primary', 'select * from users_id_seq', 0.03773, 1, '2024-05-05 19:21:57.091002', -2287331538242000302, 'elaraby'), ('primary', 'SET intervalstyle = iso_8601', 0.035036, 22, '2024-05-05 19:21:57.091002', 4804838721241299504, 'elaraby'), ('primary', 'SHOW max_identifier_length', 0.029006000000000004, 11, '2024-05-05 19:21:57.091002', -4002313057801159400, 'elaraby'), ('primary', 'DELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1', 0.026638999999999996, 2, '2024-05-05 19:21:57.091002', -5737755469260890116, 'elaraby'), ('primary', 'SELECT datname FROM pg_catalog.pg_database  WHERE datname LIKE $1
LIMIT $2', 0.023181999999999998, 1, '2024-05-05 19:21:57.091002', -5953827668125025130, 'elaraby'), ('primary', 'SELECT a.attnum, a.attname
FROM pg_attribute a
WHERE a.attrelid = $1
AND a.attnum IN ($2, $3)', 0.017594000000000002, 1, '2024-05-05 19:21:57.091002', 7512172125492570724, 'elaraby'), ('primary', 'SELECT $1::regtype::oid', 0.015658000000000002, 6, '2024-05-05 19:21:57.091002', -6637266298780066561, 'elaraby'), ('primary', 'select * from pg_extension', 0.015040000000000001, 1, '2024-05-05 19:21:57.091002', 4475487512273963842, 'elaraby'), ('primary', 'BEGIN', 0.012704000000000002, 15, '2024-05-05 19:21:57.091002', 2397681704071010949, 'elaraby') RETURNING "id"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreatePgheroSpaceStats (20240505192216)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "pghero_space_stats" ("id" bigserial primary key, "database" text, "schema" text, "relation" text, "size" bigint, "captured_at" timestamp)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE INDEX "index_pghero_space_stats_on_database_and_captured_at" ON "pghero_space_stats" ("database", "captured_at")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240505192216') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/" for 127.0.0.1 at 2024-05-05 22:22:36 +0300
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/rails/welcome/index.html.erb (Duration: 1.0ms | Allocations: 373)
Completed 200 OK in 17ms (Views: 6.4ms | ActiveRecord: 0.0ms | Allocations: 7147)


Started GET "/rails/info/routes" for 127.0.0.1 at 2024-05-05 22:22:59 +0300
Processing by Rails::InfoController#routes as HTML
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/layouts/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/rails/info/routes.html.erb within layouts/application
  Rendered collection of /home/elaraby/.rvm/gems/ruby-3.3.0/gems/actionpack-7.1.3.2/lib/action_dispatch/middleware/templates/routes/_route.html.erb [28 times] (Duration: 4.2ms | Allocations: 4589)
  Rendered collection of /home/elaraby/.rvm/gems/ruby-3.3.0/gems/actionpack-7.1.3.2/lib/action_dispatch/middleware/templates/routes/_route.html.erb [25 times] (Duration: 2.7ms | Allocations: 3457)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/actionpack-7.1.3.2/lib/action_dispatch/middleware/templates/routes/_table.html.erb (Duration: 2.1ms | Allocations: 1120)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/rails/info/routes.html.erb within layouts/application (Duration: 13.3ms | Allocations: 14383)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/layouts/application.html.erb (Duration: 13.7ms | Allocations: 14671)
Completed 200 OK in 15ms (Views: 14.3ms | ActiveRecord: 0.0ms | Allocations: 15301)


Started GET "/pghero" for 127.0.0.1 at 2024-05-05 22:23:11 +0300
Processing by PgHero::HomeController#index as HTML
  [1m[35m (0.9ms)[0m  [1m[34mSELECT * FROM pg_stat_statements LIMIT 1 /*pghero*/[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_is_in_recovery() /*pghero*/[0m
  [1m[35m (0.2ms)[0m  [1m[35mSHOW server_version_num /*pghero*/[0m
  [1m[35m (1.6ms)[0m  [1m[34mSELECT slot_name, database, active FROM pg_replication_slots /*pghero*/[0m
  [1m[35m (4.2ms)[0m  [1m[34mSELECT pid, state, application_name AS source, age(NOW(), COALESCE(query_start, xact_start)) AS duration, (wait_event IS NOT NULL) AS waiting, query, COALESCE(query_start, xact_start) AS started_at, EXTRACT(EPOCH FROM NOW() - COALESCE(query_start, xact_start)) * 1000.0 AS duration_ms, usename AS user, backend_type FROM pg_stat_activity WHERE state <> 'idle' AND pid <> pg_backend_pid() AND datname = current_database() AND NOW() - COALESCE(query_start, xact_start) > interval '60 seconds' AND query <> '<insufficient privilege>' ORDER BY COALESCE(query_start, xact_start) DESC /*pghero*/[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT state, COUNT(*) AS connections FROM pg_stat_activity GROUP BY 1 ORDER BY 2 DESC, 1 /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS table, 2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid)) AS transactions_left FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace LEFT JOIN pg_class t ON c.reltoastrelid = t.oid WHERE c.relkind = 'r' AND (2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid))) < 1500000000 ORDER BY 3, 1, 2 /*pghero*/[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT n.nspname AS table_schema, c.relname AS table, attname AS column, format_type(a.atttypid, a.atttypmod) AS column_type, pg_get_expr(d.adbin, d.adrelid) AS default_value FROM pg_catalog.pg_attribute a INNER JOIN pg_catalog.pg_class c ON c.oid = a.attrelid INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace INNER JOIN pg_catalog.pg_attrdef d ON (a.attrelid, a.attnum) = (d.adrelid, d.adnum) WHERE NOT a.attisdropped AND a.attnum > 0 AND pg_get_expr(d.adbin, d.adrelid) LIKE 'nextval%' AND n.nspname NOT LIKE 'pg\_temp\_%' /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS sequence, has_sequence_privilege(c.oid, 'SELECT') AS readable FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace WHERE c.relkind = 'S' AND n.nspname NOT IN ('pg_catalog', 'information_schema') /*pghero*/[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT last_value FROM "public"."users_id_seq" UNION ALL SELECT last_value FROM "public"."locations_id_seq" UNION ALL SELECT last_value FROM "public"."trip_requests_id_seq" UNION ALL SELECT last_value FROM "public"."trips_id_seq" UNION ALL SELECT last_value FROM "public"."vehicles_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_query_stats_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_space_stats_id_seq" /*pghero*/[0m
  [1m[35m (5.3ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT nsp.nspname AS schema, rel.relname AS table, con.conname AS name, fnsp.nspname AS referenced_schema, frel.relname AS referenced_table FROM pg_catalog.pg_constraint con INNER JOIN pg_catalog.pg_class rel ON rel.oid = con.conrelid LEFT JOIN pg_catalog.pg_class frel ON frel.oid = con.confrelid LEFT JOIN pg_catalog.pg_namespace nsp ON nsp.oid = con.connamespace LEFT JOIN pg_catalog.pg_namespace fnsp ON fnsp.oid = frel.relnamespace WHERE con.convalidated = 'f' /*pghero*/[0m
  [1m[35m (1.4ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (2.3ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-05 16:23:11.283032' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application (Duration: 3.2ms | Allocations: 4424)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 497.8ms | Allocations: 154960)
Completed 200 OK in 568ms (Views: 498.9ms | ActiveRecord: 30.5ms | Allocations: 193059)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-05 22:23:14 +0300
Processing by PgHero::HomeController#queries as HTML
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_query_stats_slider.html.erb (Duration: 0.4ms | Allocations: 297)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 1.1ms | Allocations: 1256)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application (Duration: 2.9ms | Allocations: 2312)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 5.6ms | Allocations: 5598)
Completed 200 OK in 8ms (Views: 6.1ms | ActiveRecord: 0.7ms | Allocations: 6034)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-05 22:23:14 +0300
Processing by PgHero::HomeController#queries as HTML
  [1m[35m (1.7ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (1.2ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-04 19:23:14.342096' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (5.1ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (1.8ms)[0m  [1m[34mSELECT nspname AS schema, relname AS table, reltuples::bigint AS estimated_rows, pg_total_relation_size(pg_class.oid) AS size_bytes FROM pg_class INNER JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE relkind = 'r' AND nspname = 'public' AND relname IN (NULL, 'pg_type', 'pg_stat_statements', 'pg_attribute', 'schema_migrations', 'query_stats', 'pg_stat_activity', 'pg_extension', 'ar_internal_metadata', 'pg_database', 'pg_locks') ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (2.6ms)[0m  [1m[34mSELECT schemaname AS schema, tablename AS table, attname AS column, null_frac, n_distinct FROM pg_stats WHERE schemaname = 'public' AND tablename IN (NULL, 'pg_type', 'pg_stat_statements', 'pg_attribute', 'schema_migrations', 'query_stats', 'pg_stat_activity', 'pg_extension', 'ar_internal_metadata', 'pg_database', 'pg_locks') ORDER BY 1, 2, 3 /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 21.5ms | Allocations: 16091)
Completed 200 OK in 62ms (Views: 22.2ms | ActiveRecord: 13.4ms | Allocations: 48176)


Started GET "/pghero/" for 127.0.0.1 at 2024-05-05 22:23:27 +0300
Processing by PgHero::HomeController#index as HTML
  [1m[35m (0.3ms)[0m  [1m[34mSELECT slot_name, database, active FROM pg_replication_slots /*pghero*/[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT pid, state, application_name AS source, age(NOW(), COALESCE(query_start, xact_start)) AS duration, (wait_event IS NOT NULL) AS waiting, query, COALESCE(query_start, xact_start) AS started_at, EXTRACT(EPOCH FROM NOW() - COALESCE(query_start, xact_start)) * 1000.0 AS duration_ms, usename AS user, backend_type FROM pg_stat_activity WHERE state <> 'idle' AND pid <> pg_backend_pid() AND datname = current_database() AND NOW() - COALESCE(query_start, xact_start) > interval '60 seconds' AND query <> '<insufficient privilege>' ORDER BY COALESCE(query_start, xact_start) DESC /*pghero*/[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT state, COUNT(*) AS connections FROM pg_stat_activity GROUP BY 1 ORDER BY 2 DESC, 1 /*pghero*/[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS table, 2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid)) AS transactions_left FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace LEFT JOIN pg_class t ON c.reltoastrelid = t.oid WHERE c.relkind = 'r' AND (2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid))) < 1500000000 ORDER BY 3, 1, 2 /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT n.nspname AS table_schema, c.relname AS table, attname AS column, format_type(a.atttypid, a.atttypmod) AS column_type, pg_get_expr(d.adbin, d.adrelid) AS default_value FROM pg_catalog.pg_attribute a INNER JOIN pg_catalog.pg_class c ON c.oid = a.attrelid INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace INNER JOIN pg_catalog.pg_attrdef d ON (a.attrelid, a.attnum) = (d.adrelid, d.adnum) WHERE NOT a.attisdropped AND a.attnum > 0 AND pg_get_expr(d.adbin, d.adrelid) LIKE 'nextval%' AND n.nspname NOT LIKE 'pg\_temp\_%' /*pghero*/[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS sequence, has_sequence_privilege(c.oid, 'SELECT') AS readable FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace WHERE c.relkind = 'S' AND n.nspname NOT IN ('pg_catalog', 'information_schema') /*pghero*/[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT last_value FROM "public"."users_id_seq" UNION ALL SELECT last_value FROM "public"."locations_id_seq" UNION ALL SELECT last_value FROM "public"."trip_requests_id_seq" UNION ALL SELECT last_value FROM "public"."trips_id_seq" UNION ALL SELECT last_value FROM "public"."vehicles_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_query_stats_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_space_stats_id_seq" /*pghero*/[0m
  [1m[35m (2.9ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT nsp.nspname AS schema, rel.relname AS table, con.conname AS name, fnsp.nspname AS referenced_schema, frel.relname AS referenced_table FROM pg_catalog.pg_constraint con INNER JOIN pg_catalog.pg_class rel ON rel.oid = con.conrelid LEFT JOIN pg_catalog.pg_class frel ON frel.oid = con.confrelid LEFT JOIN pg_catalog.pg_namespace nsp ON nsp.oid = con.connamespace LEFT JOIN pg_catalog.pg_namespace fnsp ON fnsp.oid = frel.relnamespace WHERE con.convalidated = 'f' /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (1.1ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-05 16:23:27.024449' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application (Duration: 0.1ms | Allocations: 27)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 3.0ms | Allocations: 3334)
Completed 200 OK in 32ms (Views: 3.5ms | ActiveRecord: 9.5ms | Allocations: 26319)


Started GET "/pghero/space" for 127.0.0.1 at 2024-05-05 22:23:30 +0300
Processing by PgHero::HomeController#space as HTML
  [1m[35m (5.7ms)[0m  [1m[34mSELECT pg_database_size(current_database()) /*pghero*/[0m
  [1m[35m (2.1ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS relation, CASE WHEN c.relkind = 'r' THEN 'table' ELSE 'index' END AS type, pg_table_size(c.oid) AS size_bytes FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname NOT IN ('pg_catalog', 'information_schema') AND n.nspname !~ '^pg_toast' AND c.relkind IN ('r', 'i') ORDER BY pg_table_size(c.oid) DESC, 2 ASC /*pghero*/[0m
  [1m[35m (0.6ms)[0m  [1m[35mWITH t AS ( SELECT schema, relation, array_agg(size ORDER BY captured_at) AS sizes FROM pghero_space_stats WHERE database = 'primary' AND captured_at >= '2024-04-28 19:23:30.245279' GROUP BY 1, 2 ) SELECT schema, relation, sizes[1] AS size_bytes FROM t ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (11.5ms)[0m  [1m[34mSELECT schemaname AS schema, relname AS table, indexrelname AS index, pg_relation_size(i.indexrelid) AS size_bytes, idx_scan as index_scans FROM pg_stat_user_indexes ui INNER JOIN pg_index i ON ui.indexrelid = i.indexrelid WHERE NOT indisunique AND idx_scan <= 0 ORDER BY pg_relation_size(i.indexrelid) DESC, relname ASC /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application
  [1m[35m (1.2ms)[0m  [1m[34mSELECT state FROM pg_stat_replication /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application (Duration: 6.5ms | Allocations: 4565)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 10.1ms | Allocations: 7851)
Completed 200 OK in 45ms (Views: 9.4ms | ActiveRecord: 21.6ms | Allocations: 20629)


Started GET "/pghero/connections" for 127.0.0.1 at 2024-05-05 22:23:40 +0300
Processing by PgHero::HomeController#connections as HTML
  [1m[35m (1.1ms)[0m  [1m[34mSELECT pg_stat_activity.pid, datname AS database, usename AS user, application_name AS source, client_addr AS ip, state, ssl FROM pg_stat_activity LEFT JOIN pg_stat_ssl ON pg_stat_activity.pid = pg_stat_ssl.pid ORDER BY pg_stat_activity.pid /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/connections.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_connections_table.html.erb (Duration: 0.4ms | Allocations: 331)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/connections.html.erb within layouts/pg_hero/application (Duration: 1.5ms | Allocations: 822)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 4.9ms | Allocations: 4129)
Completed 200 OK in 13ms (Views: 5.3ms | ActiveRecord: 1.1ms | Allocations: 5591)


Started GET "/pghero/live_queries" for 127.0.0.1 at 2024-05-05 22:23:51 +0300
Processing by PgHero::HomeController#live_queries as HTML
  [1m[35m (1.2ms)[0m  [1m[34mSELECT pid, state, application_name AS source, age(NOW(), COALESCE(query_start, xact_start)) AS duration, (wait_event IS NOT NULL) AS waiting, query, COALESCE(query_start, xact_start) AS started_at, EXTRACT(EPOCH FROM NOW() - COALESCE(query_start, xact_start)) * 1000.0 AS duration_ms, usename AS user, backend_type FROM pg_stat_activity WHERE state <> 'idle' AND pid <> pg_backend_pid() AND datname = current_database() ORDER BY COALESCE(query_start, xact_start) DESC /*pghero*/[0m
  [1m[35m (3.0ms)[0m  [1m[34mSELECT pid, phase FROM pg_stat_progress_vacuum WHERE datname = current_database() /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/live_queries.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_live_queries_table.html.erb (Duration: 0.5ms | Allocations: 534)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/live_queries.html.erb within layouts/pg_hero/application (Duration: 2.4ms | Allocations: 1177)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 5.2ms | Allocations: 4381)
Completed 200 OK in 13ms (Views: 5.7ms | ActiveRecord: 4.1ms | Allocations: 6562)


Started GET "/pghero/maintenance" for 127.0.0.1 at 2024-05-05 22:23:53 +0300
Processing by PgHero::HomeController#maintenance as HTML
  [1m[35m (14.2ms)[0m  [1m[34mSELECT schemaname AS schema, relname AS table, last_vacuum, last_autovacuum, last_analyze, last_autoanalyze, n_dead_tup AS dead_rows, n_live_tup AS live_rows FROM pg_stat_user_tables ORDER BY 1, 2 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/maintenance.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/maintenance.html.erb within layouts/pg_hero/application (Duration: 1.1ms | Allocations: 813)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 14.3ms | Allocations: 19344)
Completed 200 OK in 31ms (Views: 14.8ms | ActiveRecord: 14.2ms | Allocations: 20664)


Started GET "/pghero/explain" for 127.0.0.1 at 2024-05-05 22:23:55 +0300
Processing by PgHero::HomeController#explain as HTML
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/explain.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/explain.html.erb within layouts/pg_hero/application (Duration: 1.5ms | Allocations: 891)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 4.0ms | Allocations: 4089)
Completed 200 OK in 7ms (Views: 4.5ms | ActiveRecord: 0.0ms | Allocations: 4439)


Started POST "/pghero/explain" for 127.0.0.1 at 2024-05-05 22:24:07 +0300
Processing by PgHero::HomeController#explain as HTML
  Parameters: {"authenticity_token"=>"[FILTERED]", "query"=>"select * from users;", "commit"=>"Visualize"}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mSET LOCAL statement_timeout = 10000 /*pghero*/[0m
  [1m[35m (1.1ms)[0m  [1m[35mEXPLAIN (VERBOSE, COSTS, FORMAT JSON) select * from users; /*pghero*/[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT nspname AS schema, relname AS table, reltuples::bigint AS estimated_rows, pg_total_relation_size(pg_class.oid) AS size_bytes FROM pg_class INNER JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE relkind = 'r' AND nspname = 'public' AND relname IN ('users') ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT schemaname AS schema, tablename AS table, attname AS column, null_frac, n_distinct FROM pg_stats WHERE schemaname = 'public' AND tablename IN ('users') ORDER BY 1, 2, 3 /*pghero*/[0m
  [1m[35m (3.2ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/explain.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/explain.html.erb within layouts/pg_hero/application (Duration: 0.6ms | Allocations: 212)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 5.1ms | Allocations: 3416)
Completed 200 OK in 23ms (Views: 5.7ms | ActiveRecord: 6.7ms | Allocations: 11708)


Started POST "/pghero/explain" for 127.0.0.1 at 2024-05-05 22:24:14 +0300
Processing by PgHero::HomeController#explain as HTML
  Parameters: {"authenticity_token"=>"[FILTERED]", "query"=>"select * from users;", "commit"=>"Explain"}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.4ms)[0m  [1m[35mSET LOCAL statement_timeout = 10000 /*pghero*/[0m
  [1m[35m (0.2ms)[0m  [1m[35mEXPLAIN (FORMAT TEXT) select * from users; /*pghero*/[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT nspname AS schema, relname AS table, reltuples::bigint AS estimated_rows, pg_total_relation_size(pg_class.oid) AS size_bytes FROM pg_class INNER JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE relkind = 'r' AND nspname = 'public' AND relname IN ('users') ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT schemaname AS schema, tablename AS table, attname AS column, null_frac, n_distinct FROM pg_stats WHERE schemaname = 'public' AND tablename IN ('users') ORDER BY 1, 2, 3 /*pghero*/[0m
  [1m[35m (3.4ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/explain.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/explain.html.erb within layouts/pg_hero/application (Duration: 0.5ms | Allocations: 206)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 3.2ms | Allocations: 3410)
Completed 200 OK in 17ms (Views: 3.6ms | ActiveRecord: 6.4ms | Allocations: 11536)


Started GET "/pghero/tune" for 127.0.0.1 at 2024-05-05 22:24:17 +0300
Processing by PgHero::HomeController#tune as HTML
  [1m[35m (0.6ms)[0m  [1m[35mSHOW max_connections /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW shared_buffers /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW effective_cache_size /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW maintenance_work_mem /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW checkpoint_completion_target /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW wal_buffers /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW default_statistics_target /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW random_page_cost /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW effective_io_concurrency /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW work_mem /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW huge_pages /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW min_wal_size /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW max_wal_size /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/tune.html.erb within layouts/pg_hero/application
  [1m[35m (0.2ms)[0m  [1m[35mSHOW server_version /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/tune.html.erb within layouts/pg_hero/application (Duration: 2.3ms | Allocations: 1615)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 6.2ms | Allocations: 5023)
Completed 200 OK in 30ms (Views: 6.5ms | ActiveRecord: 1.7ms | Allocations: 17154)


  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (2.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddTripRatingCheckConstraint (20240506130920)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.4ms)[0m  [1m[35mSHOW server_version_num[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddTripRatingCheckConstraint (20240506130920)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.1ms)[0m  [1m[35mSHOW server_version_num[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "users" ADD CONSTRAINT rating_check CHECK (rating >= 1 AND rating <= 5) NOT VALID[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddTripRatingCheckConstraint (20240506130920)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.2ms)[0m  [1m[35mSHOW server_version_num[0m
  [1m[35m (4.2ms)[0m  [1m[35mALTER TABLE "trips" ADD CONSTRAINT rating_check CHECK (rating >= 1 AND rating <= 5) NOT VALID[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240506130920') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
Migrating to ValidateAddTripRatingCheckConstraint (20240506131412)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.9ms)[0m  [1m[35mSHOW server_version_num[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT relation::regclass::text FROM pg_locks WHERE mode IN ('ShareRowExclusiveLock', 'AccessExclusiveLock') AND pid = pg_backend_pid()[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "trips" VALIDATE CONSTRAINT "rating_check"[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20240506131412') RETURNING "version"[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(3716603570988616560)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/" for 127.0.0.1 at 2024-05-08 13:20:33 +0300
  [1m[36mActiveRecord::SchemaMigration Load (5.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/rails/welcome/index.html.erb (Duration: 3.9ms | Allocations: 372)
Completed 200 OK in 50ms (Views: 21.5ms | ActiveRecord: 0.0ms | Allocations: 4308)


Started GET "/pghero" for 127.0.0.1 at 2024-05-08 13:20:39 +0300
Processing by PgHero::HomeController#index as HTML
  [1m[35m (7.1ms)[0m  [1m[34mSELECT * FROM pg_stat_statements LIMIT 1 /*pghero*/[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT pg_is_in_recovery() /*pghero*/[0m
  [1m[35m (0.2ms)[0m  [1m[35mSHOW server_version_num /*pghero*/[0m
  [1m[35m (3.5ms)[0m  [1m[34mSELECT slot_name, database, active FROM pg_replication_slots /*pghero*/[0m
  [1m[35m (5.3ms)[0m  [1m[34mSELECT pid, state, application_name AS source, age(NOW(), COALESCE(query_start, xact_start)) AS duration, (wait_event IS NOT NULL) AS waiting, query, COALESCE(query_start, xact_start) AS started_at, EXTRACT(EPOCH FROM NOW() - COALESCE(query_start, xact_start)) * 1000.0 AS duration_ms, usename AS user, backend_type FROM pg_stat_activity WHERE state <> 'idle' AND pid <> pg_backend_pid() AND datname = current_database() AND NOW() - COALESCE(query_start, xact_start) > interval '60 seconds' AND query <> '<insufficient privilege>' ORDER BY COALESCE(query_start, xact_start) DESC /*pghero*/[0m
  [1m[35m (2.0ms)[0m  [1m[34mSELECT state, COUNT(*) AS connections FROM pg_stat_activity GROUP BY 1 ORDER BY 2 DESC, 1 /*pghero*/[0m
  [1m[35m (2.3ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS table, 2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid)) AS transactions_left FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace LEFT JOIN pg_class t ON c.reltoastrelid = t.oid WHERE c.relkind = 'r' AND (2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid))) < 1500000000 ORDER BY 3, 1, 2 /*pghero*/[0m
  [1m[35m (5.7ms)[0m  [1m[34mSELECT n.nspname AS table_schema, c.relname AS table, attname AS column, format_type(a.atttypid, a.atttypmod) AS column_type, pg_get_expr(d.adbin, d.adrelid) AS default_value FROM pg_catalog.pg_attribute a INNER JOIN pg_catalog.pg_class c ON c.oid = a.attrelid INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace INNER JOIN pg_catalog.pg_attrdef d ON (a.attrelid, a.attnum) = (d.adrelid, d.adnum) WHERE NOT a.attisdropped AND a.attnum > 0 AND pg_get_expr(d.adbin, d.adrelid) LIKE 'nextval%' AND n.nspname NOT LIKE 'pg\_temp\_%' /*pghero*/[0m
  [1m[35m (1.6ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS sequence, has_sequence_privilege(c.oid, 'SELECT') AS readable FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace WHERE c.relkind = 'S' AND n.nspname NOT IN ('pg_catalog', 'information_schema') /*pghero*/[0m
  [1m[35m (3.4ms)[0m  [1m[34mSELECT last_value FROM "public"."users_id_seq" UNION ALL SELECT last_value FROM "public"."locations_id_seq" UNION ALL SELECT last_value FROM "public"."trip_requests_id_seq" UNION ALL SELECT last_value FROM "public"."trips_id_seq" UNION ALL SELECT last_value FROM "public"."vehicles_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_query_stats_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_space_stats_id_seq" /*pghero*/[0m
  [1m[35m (13.3ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (4.0ms)[0m  [1m[34mSELECT nsp.nspname AS schema, rel.relname AS table, con.conname AS name, fnsp.nspname AS referenced_schema, frel.relname AS referenced_table FROM pg_catalog.pg_constraint con INNER JOIN pg_catalog.pg_class rel ON rel.oid = con.conrelid LEFT JOIN pg_catalog.pg_class frel ON frel.oid = con.confrelid LEFT JOIN pg_catalog.pg_namespace nsp ON nsp.oid = con.connamespace LEFT JOIN pg_catalog.pg_namespace fnsp ON fnsp.oid = frel.relnamespace WHERE con.convalidated = 'f' /*pghero*/[0m
  [1m[35m (5.3ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (5.8ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-08 07:20:39.819126' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application (Duration: 5.1ms | Allocations: 4428)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 85.2ms | Allocations: 33963)
Completed 200 OK in 245ms (Views: 86.9ms | ActiveRecord: 82.2ms | Allocations: 70251)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:20:45 +0300
Processing by PgHero::HomeController#queries as HTML
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_query_stats_slider.html.erb (Duration: 0.6ms | Allocations: 300)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 1.6ms | Allocations: 1261)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application (Duration: 4.3ms | Allocations: 2357)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 8.4ms | Allocations: 5643)
Completed 200 OK in 12ms (Views: 9.0ms | ActiveRecord: 0.7ms | Allocations: 6079)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:20:45 +0300
Processing by PgHero::HomeController#queries as HTML
  [1m[35m (3.5ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (0.9ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-07 10:20:45.482585' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (5.8ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (2.0ms)[0m  [1m[34mSELECT nspname AS schema, relname AS table, reltuples::bigint AS estimated_rows, pg_total_relation_size(pg_class.oid) AS size_bytes FROM pg_class INNER JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE relkind = 'r' AND nspname = 'public' AND relname IN (NULL, 'users', 'pg_stat_user_tables', 'pg_stat_statements', 'query_stats', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_extension', 'pg_database', 'pg_attribute', 'ar_internal_metadata', 'pg_stats', 'pg_locks', 'pg_stat_replication', 'pg_replication_slots', 'pg_policy') ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (5.8ms)[0m  [1m[34mSELECT schemaname AS schema, tablename AS table, attname AS column, null_frac, n_distinct FROM pg_stats WHERE schemaname = 'public' AND tablename IN (NULL, 'users', 'pg_stat_user_tables', 'pg_stat_statements', 'query_stats', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_extension', 'pg_database', 'pg_attribute', 'ar_internal_metadata', 'pg_stats', 'pg_locks', 'pg_stat_replication', 'pg_replication_slots', 'pg_policy') ORDER BY 1, 2, 3 /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 15.8ms | Allocations: 14682)
Completed 200 OK in 101ms (Views: 16.5ms | ActiveRecord: 21.0ms | Allocations: 51546)


Started GET "/pghero/space" for 127.0.0.1 at 2024-05-08 13:20:46 +0300
Processing by PgHero::HomeController#space as HTML
  [1m[35m (5.6ms)[0m  [1m[34mSELECT pg_database_size(current_database()) /*pghero*/[0m
  [1m[35m (3.0ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS relation, CASE WHEN c.relkind = 'r' THEN 'table' ELSE 'index' END AS type, pg_table_size(c.oid) AS size_bytes FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname NOT IN ('pg_catalog', 'information_schema') AND n.nspname !~ '^pg_toast' AND c.relkind IN ('r', 'i') ORDER BY pg_table_size(c.oid) DESC, 2 ASC /*pghero*/[0m
  [1m[35m (2.0ms)[0m  [1m[35mWITH t AS ( SELECT schema, relation, array_agg(size ORDER BY captured_at) AS sizes FROM pghero_space_stats WHERE database = 'primary' AND captured_at >= '2024-05-01 10:20:46.083585' GROUP BY 1, 2 ) SELECT schema, relation, sizes[1] AS size_bytes FROM t ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (12.9ms)[0m  [1m[34mSELECT schemaname AS schema, relname AS table, indexrelname AS index, pg_relation_size(i.indexrelid) AS size_bytes, idx_scan as index_scans FROM pg_stat_user_indexes ui INNER JOIN pg_index i ON ui.indexrelid = i.indexrelid WHERE NOT indisunique AND idx_scan <= 0 ORDER BY pg_relation_size(i.indexrelid) DESC, relname ASC /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application
  [1m[35m (0.8ms)[0m  [1m[34mSELECT state FROM pg_stat_replication /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application (Duration: 5.5ms | Allocations: 4621)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 9.6ms | Allocations: 7958)
Completed 200 OK in 60ms (Views: 9.5ms | ActiveRecord: 25.9ms | Allocations: 20316)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:20:47 +0300
Processing by PgHero::HomeController#queries as HTML
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_query_stats_slider.html.erb (Duration: 0.1ms | Allocations: 70)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 0.4ms | Allocations: 271)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application (Duration: 1.1ms | Allocations: 456)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 4.3ms | Allocations: 3742)
Completed 200 OK in 6ms (Views: 4.9ms | ActiveRecord: 0.6ms | Allocations: 4084)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:20:47 +0300
Processing by PgHero::HomeController#queries as HTML
  [1m[35m (2.2ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-07 10:20:47.868007' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (5.2ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT nspname AS schema, relname AS table, reltuples::bigint AS estimated_rows, pg_total_relation_size(pg_class.oid) AS size_bytes FROM pg_class INNER JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE relkind = 'r' AND nspname = 'public' AND relname IN (NULL, 'users', 'pg_stat_user_tables', 'pg_stat_statements', 'query_stats', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_extension', 'pg_database', 'pg_stats', 'pg_attribute', 'ar_internal_metadata', 'pg_locks', 'pg_stat_replication', 'pg_replication_slots', 'pg_policy') ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT schemaname AS schema, tablename AS table, attname AS column, null_frac, n_distinct FROM pg_stats WHERE schemaname = 'public' AND tablename IN (NULL, 'users', 'pg_stat_user_tables', 'pg_stat_statements', 'query_stats', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_extension', 'pg_database', 'pg_stats', 'pg_attribute', 'ar_internal_metadata', 'pg_locks', 'pg_stat_replication', 'pg_replication_slots', 'pg_policy') ORDER BY 1, 2, 3 /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 34.8ms | Allocations: 13362)
Completed 200 OK in 90ms (Views: 35.8ms | ActiveRecord: 12.1ms | Allocations: 49711)


Started GET "/pghero/" for 127.0.0.1 at 2024-05-08 13:20:48 +0300
Processing by PgHero::HomeController#index as HTML
  [1m[35m (0.4ms)[0m  [1m[34mSELECT slot_name, database, active FROM pg_replication_slots /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT pid, state, application_name AS source, age(NOW(), COALESCE(query_start, xact_start)) AS duration, (wait_event IS NOT NULL) AS waiting, query, COALESCE(query_start, xact_start) AS started_at, EXTRACT(EPOCH FROM NOW() - COALESCE(query_start, xact_start)) * 1000.0 AS duration_ms, usename AS user, backend_type FROM pg_stat_activity WHERE state <> 'idle' AND pid <> pg_backend_pid() AND datname = current_database() AND NOW() - COALESCE(query_start, xact_start) > interval '60 seconds' AND query <> '<insufficient privilege>' ORDER BY COALESCE(query_start, xact_start) DESC /*pghero*/[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT state, COUNT(*) AS connections FROM pg_stat_activity GROUP BY 1 ORDER BY 2 DESC, 1 /*pghero*/[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS table, 2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid)) AS transactions_left FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace LEFT JOIN pg_class t ON c.reltoastrelid = t.oid WHERE c.relkind = 'r' AND (2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid))) < 1500000000 ORDER BY 3, 1, 2 /*pghero*/[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT n.nspname AS table_schema, c.relname AS table, attname AS column, format_type(a.atttypid, a.atttypmod) AS column_type, pg_get_expr(d.adbin, d.adrelid) AS default_value FROM pg_catalog.pg_attribute a INNER JOIN pg_catalog.pg_class c ON c.oid = a.attrelid INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace INNER JOIN pg_catalog.pg_attrdef d ON (a.attrelid, a.attnum) = (d.adrelid, d.adnum) WHERE NOT a.attisdropped AND a.attnum > 0 AND pg_get_expr(d.adbin, d.adrelid) LIKE 'nextval%' AND n.nspname NOT LIKE 'pg\_temp\_%' /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS sequence, has_sequence_privilege(c.oid, 'SELECT') AS readable FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace WHERE c.relkind = 'S' AND n.nspname NOT IN ('pg_catalog', 'information_schema') /*pghero*/[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT last_value FROM "public"."users_id_seq" UNION ALL SELECT last_value FROM "public"."locations_id_seq" UNION ALL SELECT last_value FROM "public"."trip_requests_id_seq" UNION ALL SELECT last_value FROM "public"."trips_id_seq" UNION ALL SELECT last_value FROM "public"."vehicles_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_query_stats_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_space_stats_id_seq" /*pghero*/[0m
  [1m[35m (2.9ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT nsp.nspname AS schema, rel.relname AS table, con.conname AS name, fnsp.nspname AS referenced_schema, frel.relname AS referenced_table FROM pg_catalog.pg_constraint con INNER JOIN pg_catalog.pg_class rel ON rel.oid = con.conrelid LEFT JOIN pg_catalog.pg_class frel ON frel.oid = con.confrelid LEFT JOIN pg_catalog.pg_namespace nsp ON nsp.oid = con.connamespace LEFT JOIN pg_catalog.pg_namespace fnsp ON fnsp.oid = frel.relnamespace WHERE con.convalidated = 'f' /*pghero*/[0m
  [1m[35m (1.6ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (0.5ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-08 07:20:48.234315' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application (Duration: 0.1ms | Allocations: 27)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 4.9ms | Allocations: 3379)
Completed 200 OK in 45ms (Views: 5.6ms | ActiveRecord: 13.0ms | Allocations: 24032)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:21:09 +0300
Processing by PgHero::HomeController#queries as HTML
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_query_stats_slider.html.erb (Duration: 0.1ms | Allocations: 70)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 0.5ms | Allocations: 271)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application (Duration: 0.9ms | Allocations: 456)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 4.5ms | Allocations: 3742)
Completed 200 OK in 7ms (Views: 5.1ms | ActiveRecord: 0.6ms | Allocations: 4090)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:21:09 +0300
Processing by PgHero::HomeController#queries as HTML
  [1m[35m (3.2ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (0.5ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-07 10:21:09.454964' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (4.3ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT nspname AS schema, relname AS table, reltuples::bigint AS estimated_rows, pg_total_relation_size(pg_class.oid) AS size_bytes FROM pg_class INNER JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE relkind = 'r' AND nspname = 'public' AND relname IN (NULL, 'users', 'pg_stat_user_tables', 'query_stats', 'pg_stat_statements', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_extension', 'pg_stats', 'pg_database', 'pg_attribute', 'ar_internal_metadata', 'pg_locks', 'pg_stat_replication', 'pg_replication_slots', 'pg_policy') ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT schemaname AS schema, tablename AS table, attname AS column, null_frac, n_distinct FROM pg_stats WHERE schemaname = 'public' AND tablename IN (NULL, 'users', 'pg_stat_user_tables', 'query_stats', 'pg_stat_statements', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_extension', 'pg_stats', 'pg_database', 'pg_attribute', 'ar_internal_metadata', 'pg_locks', 'pg_stat_replication', 'pg_replication_slots', 'pg_policy') ORDER BY 1, 2, 3 /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 16.2ms | Allocations: 13362)
Completed 200 OK in 80ms (Views: 17.7ms | ActiveRecord: 11.5ms | Allocations: 49714)


Started GET "/pghero/space" for 127.0.0.1 at 2024-05-08 13:21:09 +0300
Processing by PgHero::HomeController#space as HTML
  [1m[35m (1.5ms)[0m  [1m[34mSELECT pg_database_size(current_database()) /*pghero*/[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS relation, CASE WHEN c.relkind = 'r' THEN 'table' ELSE 'index' END AS type, pg_table_size(c.oid) AS size_bytes FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname NOT IN ('pg_catalog', 'information_schema') AND n.nspname !~ '^pg_toast' AND c.relkind IN ('r', 'i') ORDER BY pg_table_size(c.oid) DESC, 2 ASC /*pghero*/[0m
  [1m[35m (0.4ms)[0m  [1m[35mWITH t AS ( SELECT schema, relation, array_agg(size ORDER BY captured_at) AS sizes FROM pghero_space_stats WHERE database = 'primary' AND captured_at >= '2024-05-01 10:21:10.011397' GROUP BY 1, 2 ) SELECT schema, relation, sizes[1] AS size_bytes FROM t ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (12.4ms)[0m  [1m[34mSELECT schemaname AS schema, relname AS table, indexrelname AS index, pg_relation_size(i.indexrelid) AS size_bytes, idx_scan as index_scans FROM pg_stat_user_indexes ui INNER JOIN pg_index i ON ui.indexrelid = i.indexrelid WHERE NOT indisunique AND idx_scan <= 0 ORDER BY pg_relation_size(i.indexrelid) DESC, relname ASC /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application
  [1m[35m (0.9ms)[0m  [1m[34mSELECT state FROM pg_stat_replication /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application (Duration: 6.3ms | Allocations: 3631)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 12.1ms | Allocations: 6968)
Completed 200 OK in 44ms (Views: 12.4ms | ActiveRecord: 17.2ms | Allocations: 18626)


Started GET "/pghero/" for 127.0.0.1 at 2024-05-08 13:21:10 +0300
Processing by PgHero::HomeController#index as HTML
  [1m[35m (0.4ms)[0m  [1m[34mSELECT slot_name, database, active FROM pg_replication_slots /*pghero*/[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pid, state, application_name AS source, age(NOW(), COALESCE(query_start, xact_start)) AS duration, (wait_event IS NOT NULL) AS waiting, query, COALESCE(query_start, xact_start) AS started_at, EXTRACT(EPOCH FROM NOW() - COALESCE(query_start, xact_start)) * 1000.0 AS duration_ms, usename AS user, backend_type FROM pg_stat_activity WHERE state <> 'idle' AND pid <> pg_backend_pid() AND datname = current_database() AND NOW() - COALESCE(query_start, xact_start) > interval '60 seconds' AND query <> '<insufficient privilege>' ORDER BY COALESCE(query_start, xact_start) DESC /*pghero*/[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT state, COUNT(*) AS connections FROM pg_stat_activity GROUP BY 1 ORDER BY 2 DESC, 1 /*pghero*/[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS table, 2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid)) AS transactions_left FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace LEFT JOIN pg_class t ON c.reltoastrelid = t.oid WHERE c.relkind = 'r' AND (2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid))) < 1500000000 ORDER BY 3, 1, 2 /*pghero*/[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT n.nspname AS table_schema, c.relname AS table, attname AS column, format_type(a.atttypid, a.atttypmod) AS column_type, pg_get_expr(d.adbin, d.adrelid) AS default_value FROM pg_catalog.pg_attribute a INNER JOIN pg_catalog.pg_class c ON c.oid = a.attrelid INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace INNER JOIN pg_catalog.pg_attrdef d ON (a.attrelid, a.attnum) = (d.adrelid, d.adnum) WHERE NOT a.attisdropped AND a.attnum > 0 AND pg_get_expr(d.adbin, d.adrelid) LIKE 'nextval%' AND n.nspname NOT LIKE 'pg\_temp\_%' /*pghero*/[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS sequence, has_sequence_privilege(c.oid, 'SELECT') AS readable FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace WHERE c.relkind = 'S' AND n.nspname NOT IN ('pg_catalog', 'information_schema') /*pghero*/[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT last_value FROM "public"."users_id_seq" UNION ALL SELECT last_value FROM "public"."locations_id_seq" UNION ALL SELECT last_value FROM "public"."trip_requests_id_seq" UNION ALL SELECT last_value FROM "public"."trips_id_seq" UNION ALL SELECT last_value FROM "public"."vehicles_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_query_stats_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_space_stats_id_seq" /*pghero*/[0m
  [1m[35m (3.9ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT nsp.nspname AS schema, rel.relname AS table, con.conname AS name, fnsp.nspname AS referenced_schema, frel.relname AS referenced_table FROM pg_catalog.pg_constraint con INNER JOIN pg_catalog.pg_class rel ON rel.oid = con.conrelid LEFT JOIN pg_catalog.pg_class frel ON frel.oid = con.confrelid LEFT JOIN pg_catalog.pg_namespace nsp ON nsp.oid = con.connamespace LEFT JOIN pg_catalog.pg_namespace fnsp ON fnsp.oid = frel.relnamespace WHERE con.convalidated = 'f' /*pghero*/[0m
  [1m[35m (1.4ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (0.5ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-08 07:21:10.991741' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application (Duration: 0.1ms | Allocations: 27)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 3.8ms | Allocations: 3379)
Completed 200 OK in 37ms (Views: 4.4ms | ActiveRecord: 11.4ms | Allocations: 24032)


Started GET "/pghero/space" for 127.0.0.1 at 2024-05-08 13:21:11 +0300
Processing by PgHero::HomeController#space as HTML
  [1m[35m (1.4ms)[0m  [1m[34mSELECT pg_database_size(current_database()) /*pghero*/[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS relation, CASE WHEN c.relkind = 'r' THEN 'table' ELSE 'index' END AS type, pg_table_size(c.oid) AS size_bytes FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname NOT IN ('pg_catalog', 'information_schema') AND n.nspname !~ '^pg_toast' AND c.relkind IN ('r', 'i') ORDER BY pg_table_size(c.oid) DESC, 2 ASC /*pghero*/[0m
  [1m[35m (0.4ms)[0m  [1m[35mWITH t AS ( SELECT schema, relation, array_agg(size ORDER BY captured_at) AS sizes FROM pghero_space_stats WHERE database = 'primary' AND captured_at >= '2024-05-01 10:21:11.661927' GROUP BY 1, 2 ) SELECT schema, relation, sizes[1] AS size_bytes FROM t ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (12.1ms)[0m  [1m[34mSELECT schemaname AS schema, relname AS table, indexrelname AS index, pg_relation_size(i.indexrelid) AS size_bytes, idx_scan as index_scans FROM pg_stat_user_indexes ui INNER JOIN pg_index i ON ui.indexrelid = i.indexrelid WHERE NOT indisunique AND idx_scan <= 0 ORDER BY pg_relation_size(i.indexrelid) DESC, relname ASC /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application
  [1m[35m (0.8ms)[0m  [1m[34mSELECT state FROM pg_stat_replication /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application (Duration: 4.1ms | Allocations: 3631)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 8.1ms | Allocations: 6918)
Completed 200 OK in 40ms (Views: 7.9ms | ActiveRecord: 17.1ms | Allocations: 18579)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:21:12 +0300
Processing by PgHero::HomeController#queries as HTML
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_query_stats_slider.html.erb (Duration: 0.1ms | Allocations: 70)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 0.4ms | Allocations: 271)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application (Duration: 0.7ms | Allocations: 456)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 6.2ms | Allocations: 3763)
Completed 200 OK in 8ms (Views: 6.7ms | ActiveRecord: 0.6ms | Allocations: 4106)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:21:12 +0300
Processing by PgHero::HomeController#queries as HTML
  [1m[35m (2.1ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-07 10:21:12.796018' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (7.6ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (2.1ms)[0m  [1m[34mSELECT nspname AS schema, relname AS table, reltuples::bigint AS estimated_rows, pg_total_relation_size(pg_class.oid) AS size_bytes FROM pg_class INNER JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE relkind = 'r' AND nspname = 'public' AND relname IN (NULL, 'users', 'pg_stat_user_tables', 'query_stats', 'pg_stat_statements', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_stats', 'pg_extension', 'pg_database', 'pg_stat_replication', 'pg_attribute', 'ar_internal_metadata', 'pg_locks', 'pg_replication_slots', 'pg_policy', 't') ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (2.5ms)[0m  [1m[34mSELECT schemaname AS schema, tablename AS table, attname AS column, null_frac, n_distinct FROM pg_stats WHERE schemaname = 'public' AND tablename IN (NULL, 'users', 'pg_stat_user_tables', 'query_stats', 'pg_stat_statements', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_stats', 'pg_extension', 'pg_database', 'pg_stat_replication', 'pg_attribute', 'ar_internal_metadata', 'pg_locks', 'pg_replication_slots', 'pg_policy', 't') ORDER BY 1, 2, 3 /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 15.2ms | Allocations: 13362)
Completed 200 OK in 81ms (Views: 16.4ms | ActiveRecord: 16.5ms | Allocations: 49687)


Started GET "/pghero/space" for 127.0.0.1 at 2024-05-08 13:21:17 +0300
Processing by PgHero::HomeController#space as HTML
  [1m[35m (1.2ms)[0m  [1m[34mSELECT pg_database_size(current_database()) /*pghero*/[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS relation, CASE WHEN c.relkind = 'r' THEN 'table' ELSE 'index' END AS type, pg_table_size(c.oid) AS size_bytes FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname NOT IN ('pg_catalog', 'information_schema') AND n.nspname !~ '^pg_toast' AND c.relkind IN ('r', 'i') ORDER BY pg_table_size(c.oid) DESC, 2 ASC /*pghero*/[0m
  [1m[35m (0.3ms)[0m  [1m[35mWITH t AS ( SELECT schema, relation, array_agg(size ORDER BY captured_at) AS sizes FROM pghero_space_stats WHERE database = 'primary' AND captured_at >= '2024-05-01 10:21:17.702300' GROUP BY 1, 2 ) SELECT schema, relation, sizes[1] AS size_bytes FROM t ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (11.6ms)[0m  [1m[34mSELECT schemaname AS schema, relname AS table, indexrelname AS index, pg_relation_size(i.indexrelid) AS size_bytes, idx_scan as index_scans FROM pg_stat_user_indexes ui INNER JOIN pg_index i ON ui.indexrelid = i.indexrelid WHERE NOT indisunique AND idx_scan <= 0 ORDER BY pg_relation_size(i.indexrelid) DESC, relname ASC /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application
  [1m[35m (0.7ms)[0m  [1m[34mSELECT state FROM pg_stat_replication /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application (Duration: 4.5ms | Allocations: 3631)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 10.4ms | Allocations: 6968)
Completed 200 OK in 38ms (Views: 10.4ms | ActiveRecord: 15.8ms | Allocations: 18621)


Started GET "/pghero/connections" for 127.0.0.1 at 2024-05-08 13:21:24 +0300
Processing by PgHero::HomeController#connections as HTML
  [1m[35m (1.3ms)[0m  [1m[34mSELECT pg_stat_activity.pid, datname AS database, usename AS user, application_name AS source, client_addr AS ip, state, ssl FROM pg_stat_activity LEFT JOIN pg_stat_ssl ON pg_stat_activity.pid = pg_stat_ssl.pid ORDER BY pg_stat_activity.pid /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/connections.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_connections_table.html.erb (Duration: 0.9ms | Allocations: 299)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/connections.html.erb within layouts/pg_hero/application (Duration: 3.9ms | Allocations: 792)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 10.1ms | Allocations: 4118)
Completed 200 OK in 26ms (Views: 11.0ms | ActiveRecord: 1.2ms | Allocations: 5548)


Started GET "/pghero/" for 127.0.0.1 at 2024-05-08 13:21:57 +0300
Processing by PgHero::HomeController#index as HTML
  [1m[35m (0.7ms)[0m  [1m[34mSELECT slot_name, database, active FROM pg_replication_slots /*pghero*/[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT pid, state, application_name AS source, age(NOW(), COALESCE(query_start, xact_start)) AS duration, (wait_event IS NOT NULL) AS waiting, query, COALESCE(query_start, xact_start) AS started_at, EXTRACT(EPOCH FROM NOW() - COALESCE(query_start, xact_start)) * 1000.0 AS duration_ms, usename AS user, backend_type FROM pg_stat_activity WHERE state <> 'idle' AND pid <> pg_backend_pid() AND datname = current_database() AND NOW() - COALESCE(query_start, xact_start) > interval '60 seconds' AND query <> '<insufficient privilege>' ORDER BY COALESCE(query_start, xact_start) DESC /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT state, COUNT(*) AS connections FROM pg_stat_activity GROUP BY 1 ORDER BY 2 DESC, 1 /*pghero*/[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS table, 2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid)) AS transactions_left FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace LEFT JOIN pg_class t ON c.reltoastrelid = t.oid WHERE c.relkind = 'r' AND (2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid))) < 1500000000 ORDER BY 3, 1, 2 /*pghero*/[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT n.nspname AS table_schema, c.relname AS table, attname AS column, format_type(a.atttypid, a.atttypmod) AS column_type, pg_get_expr(d.adbin, d.adrelid) AS default_value FROM pg_catalog.pg_attribute a INNER JOIN pg_catalog.pg_class c ON c.oid = a.attrelid INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace INNER JOIN pg_catalog.pg_attrdef d ON (a.attrelid, a.attnum) = (d.adrelid, d.adnum) WHERE NOT a.attisdropped AND a.attnum > 0 AND pg_get_expr(d.adbin, d.adrelid) LIKE 'nextval%' AND n.nspname NOT LIKE 'pg\_temp\_%' /*pghero*/[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS sequence, has_sequence_privilege(c.oid, 'SELECT') AS readable FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace WHERE c.relkind = 'S' AND n.nspname NOT IN ('pg_catalog', 'information_schema') /*pghero*/[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT last_value FROM "public"."users_id_seq" UNION ALL SELECT last_value FROM "public"."locations_id_seq" UNION ALL SELECT last_value FROM "public"."trip_requests_id_seq" UNION ALL SELECT last_value FROM "public"."trips_id_seq" UNION ALL SELECT last_value FROM "public"."vehicles_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_query_stats_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_space_stats_id_seq" /*pghero*/[0m
  [1m[35m (4.3ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT nsp.nspname AS schema, rel.relname AS table, con.conname AS name, fnsp.nspname AS referenced_schema, frel.relname AS referenced_table FROM pg_catalog.pg_constraint con INNER JOIN pg_catalog.pg_class rel ON rel.oid = con.conrelid LEFT JOIN pg_catalog.pg_class frel ON frel.oid = con.confrelid LEFT JOIN pg_catalog.pg_namespace nsp ON nsp.oid = con.connamespace LEFT JOIN pg_catalog.pg_namespace fnsp ON fnsp.oid = frel.relnamespace WHERE con.convalidated = 'f' /*pghero*/[0m
  [1m[35m (2.0ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (0.7ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-08 07:21:57.184307' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application (Duration: 0.1ms | Allocations: 27)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 4.9ms | Allocations: 3328)
Completed 200 OK in 45ms (Views: 5.6ms | ActiveRecord: 15.7ms | Allocations: 24058)


Started GET "/pghero/space" for 127.0.0.1 at 2024-05-08 13:22:00 +0300
Processing by PgHero::HomeController#space as HTML
  [1m[35m (1.9ms)[0m  [1m[34mSELECT pg_database_size(current_database()) /*pghero*/[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS relation, CASE WHEN c.relkind = 'r' THEN 'table' ELSE 'index' END AS type, pg_table_size(c.oid) AS size_bytes FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname NOT IN ('pg_catalog', 'information_schema') AND n.nspname !~ '^pg_toast' AND c.relkind IN ('r', 'i') ORDER BY pg_table_size(c.oid) DESC, 2 ASC /*pghero*/[0m
  [1m[35m (0.4ms)[0m  [1m[35mWITH t AS ( SELECT schema, relation, array_agg(size ORDER BY captured_at) AS sizes FROM pghero_space_stats WHERE database = 'primary' AND captured_at >= '2024-05-01 10:22:00.583769' GROUP BY 1, 2 ) SELECT schema, relation, sizes[1] AS size_bytes FROM t ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (12.2ms)[0m  [1m[34mSELECT schemaname AS schema, relname AS table, indexrelname AS index, pg_relation_size(i.indexrelid) AS size_bytes, idx_scan as index_scans FROM pg_stat_user_indexes ui INNER JOIN pg_index i ON ui.indexrelid = i.indexrelid WHERE NOT indisunique AND idx_scan <= 0 ORDER BY pg_relation_size(i.indexrelid) DESC, relname ASC /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application
  [1m[35m (0.8ms)[0m  [1m[34mSELECT state FROM pg_stat_replication /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/space.html.erb within layouts/pg_hero/application (Duration: 6.1ms | Allocations: 3630)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 12.4ms | Allocations: 6968)
Completed 200 OK in 51ms (Views: 12.3ms | ActiveRecord: 18.0ms | Allocations: 18620)


Started GET "/" for 127.0.0.1 at 2024-05-08 13:46:13 +0300
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/railties-7.1.3.2/lib/rails/templates/rails/welcome/index.html.erb (Duration: 1.3ms | Allocations: 372)
Completed 200 OK in 22ms (Views: 6.1ms | ActiveRecord: 0.0ms | Allocations: 4308)


Started GET "/pghero" for 127.0.0.1 at 2024-05-08 13:46:19 +0300
Processing by PgHero::HomeController#index as HTML
  [1m[35m (0.7ms)[0m  [1m[34mSELECT * FROM pg_stat_statements LIMIT 1 /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_is_in_recovery() /*pghero*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mSHOW server_version_num /*pghero*/[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT slot_name, database, active FROM pg_replication_slots /*pghero*/[0m
  [1m[35m (2.4ms)[0m  [1m[34mSELECT pid, state, application_name AS source, age(NOW(), COALESCE(query_start, xact_start)) AS duration, (wait_event IS NOT NULL) AS waiting, query, COALESCE(query_start, xact_start) AS started_at, EXTRACT(EPOCH FROM NOW() - COALESCE(query_start, xact_start)) * 1000.0 AS duration_ms, usename AS user, backend_type FROM pg_stat_activity WHERE state <> 'idle' AND pid <> pg_backend_pid() AND datname = current_database() AND NOW() - COALESCE(query_start, xact_start) > interval '60 seconds' AND query <> '<insufficient privilege>' ORDER BY COALESCE(query_start, xact_start) DESC /*pghero*/[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT state, COUNT(*) AS connections FROM pg_stat_activity GROUP BY 1 ORDER BY 2 DESC, 1 /*pghero*/[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS table, 2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid)) AS transactions_left FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace LEFT JOIN pg_class t ON c.reltoastrelid = t.oid WHERE c.relkind = 'r' AND (2146483648 - GREATEST(AGE(c.relfrozenxid), AGE(t.relfrozenxid))) < 1500000000 ORDER BY 3, 1, 2 /*pghero*/[0m
  [1m[35m (2.4ms)[0m  [1m[34mSELECT n.nspname AS table_schema, c.relname AS table, attname AS column, format_type(a.atttypid, a.atttypmod) AS column_type, pg_get_expr(d.adbin, d.adrelid) AS default_value FROM pg_catalog.pg_attribute a INNER JOIN pg_catalog.pg_class c ON c.oid = a.attrelid INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace INNER JOIN pg_catalog.pg_attrdef d ON (a.attrelid, a.attnum) = (d.adrelid, d.adnum) WHERE NOT a.attisdropped AND a.attnum > 0 AND pg_get_expr(d.adbin, d.adrelid) LIKE 'nextval%' AND n.nspname NOT LIKE 'pg\_temp\_%' /*pghero*/[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT n.nspname AS schema, c.relname AS sequence, has_sequence_privilege(c.oid, 'SELECT') AS readable FROM pg_class c INNER JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace WHERE c.relkind = 'S' AND n.nspname NOT IN ('pg_catalog', 'information_schema') /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT last_value FROM "public"."users_id_seq" UNION ALL SELECT last_value FROM "public"."locations_id_seq" UNION ALL SELECT last_value FROM "public"."trip_requests_id_seq" UNION ALL SELECT last_value FROM "public"."trips_id_seq" UNION ALL SELECT last_value FROM "public"."vehicles_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_query_stats_id_seq" UNION ALL SELECT last_value FROM "public"."pghero_space_stats_id_seq" /*pghero*/[0m
  [1m[35m (5.1ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT nsp.nspname AS schema, rel.relname AS table, con.conname AS name, fnsp.nspname AS referenced_schema, frel.relname AS referenced_table FROM pg_catalog.pg_constraint con INNER JOIN pg_catalog.pg_class rel ON rel.oid = con.conrelid LEFT JOIN pg_catalog.pg_class frel ON frel.oid = con.confrelid LEFT JOIN pg_catalog.pg_namespace nsp ON nsp.oid = con.connamespace LEFT JOIN pg_catalog.pg_namespace fnsp ON fnsp.oid = frel.relnamespace WHERE con.convalidated = 'f' /*pghero*/[0m
  [1m[35m (2.2ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (1.3ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-08 07:46:19.274876' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/index.html.erb within layouts/pg_hero/application (Duration: 3.9ms | Allocations: 4428)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 86.0ms | Allocations: 33938)
Completed 200 OK in 192ms (Views: 87.7ms | ActiveRecord: 29.4ms | Allocations: 70297)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:46:48 +0300
Processing by PgHero::HomeController#queries as HTML
  Rendering layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb
  Rendering /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_query_stats_slider.html.erb (Duration: 0.7ms | Allocations: 300)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 2.2ms | Allocations: 1261)
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/queries.html.erb within layouts/pg_hero/application (Duration: 5.4ms | Allocations: 2357)
  Rendered layout /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/layouts/pg_hero/application.html.erb (Duration: 9.0ms | Allocations: 5647)
Completed 200 OK in 11ms (Views: 9.6ms | ActiveRecord: 0.6ms | Allocations: 6083)


Started GET "/pghero/queries" for 127.0.0.1 at 2024-05-08 13:46:48 +0300
Processing by PgHero::HomeController#queries as HTML
  [1m[35m (2.3ms)[0m  [1m[35mWITH query_stats AS ( SELECT LEFT(query, 10000) AS query, queryid AS query_hash, rolname AS user, ((total_plan_time + total_exec_time) / 1000 / 60) AS total_minutes, ((total_plan_time + total_exec_time) / calls) AS average_time, calls FROM pg_stat_statements INNER JOIN pg_database ON pg_database.oid = pg_stat_statements.dbid INNER JOIN pg_roles ON pg_roles.oid = pg_stat_statements.userid WHERE calls > 0 AND pg_database.datname = current_database() ) SELECT query, query AS explainable_query, query_hash, query_stats.user, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (0.4ms)[0m  [1m[35mWITH query_stats AS ( SELECT query_hash AS query_hash, pghero_query_stats.user AS user, array_agg(LEFT(query, 10000) ORDER BY REPLACE(LEFT(query, 1000), '?', '!') COLLATE "C" ASC) AS query, (SUM(total_time) / 1000 / 60) AS total_minutes, (SUM(total_time) / SUM(calls)) AS average_time, SUM(calls) AS calls FROM pghero_query_stats WHERE database = 'primary' AND query_hash IS NOT NULL AND captured_at >= '2024-05-07 10:46:48.463639' GROUP BY 1, 2 ) SELECT query_hash, query_stats.user, query[1] AS query, query[array_length(query, 1)] AS explainable_query, total_minutes, average_time, calls, total_minutes * 100.0 / (SELECT SUM(total_minutes) FROM query_stats) AS total_percent, (SELECT SUM(total_minutes) FROM query_stats) AS all_queries_total_minutes FROM query_stats ORDER BY "total_minutes" DESC LIMIT 100 /*pghero*/[0m
  [1m[35m (4.3ms)[0m  [1m[34mSELECT schemaname AS schema, t.relname AS table, ix.relname AS name, regexp_replace(pg_get_indexdef(i.indexrelid), '^[^\(]*\((.*)\)$', '\1') AS columns, regexp_replace(pg_get_indexdef(i.indexrelid), '.* USING ([^ ]*) \(.*', '\1') AS using, indisunique AS unique, indisprimary AS primary, indisvalid AS valid, indexprs::text, indpred::text, pg_get_indexdef(i.indexrelid) AS definition FROM pg_index i INNER JOIN pg_class t ON t.oid = i.indrelid INNER JOIN pg_class ix ON ix.oid = i.indexrelid LEFT JOIN pg_stat_user_indexes ui ON ui.indexrelid = i.indexrelid WHERE schemaname IS NOT NULL ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT nspname AS schema, relname AS table, reltuples::bigint AS estimated_rows, pg_total_relation_size(pg_class.oid) AS size_bytes FROM pg_class INNER JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace WHERE relkind = 'r' AND nspname = 'public' AND relname IN (NULL, 'users', 'pg_stat_user_tables', 'query_stats', 'pg_stat_statements', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_stats', 'pg_extension', 'pg_database', 'pg_stat_replication', 'pg_attribute', 'ar_internal_metadata', 'pg_locks', 'pg_replication_slots', 't', 'pg_policy') ORDER BY 1, 2 /*pghero*/[0m
  [1m[35m (2.0ms)[0m  [1m[34mSELECT schemaname AS schema, tablename AS table, attname AS column, null_frac, n_distinct FROM pg_stats WHERE schemaname = 'public' AND tablename IN (NULL, 'users', 'pg_stat_user_tables', 'query_stats', 'pg_stat_statements', 'pg_type', 'pg_stat_activity', 'pg_class', 'schema_migrations', 'pg_stats', 'pg_extension', 'pg_database', 'pg_stat_replication', 'pg_attribute', 'ar_internal_metadata', 'pg_locks', 'pg_replication_slots', 't', 'pg_policy') ORDER BY 1, 2, 3 /*pghero*/[0m
  Rendered /home/elaraby/.rvm/gems/ruby-3.3.0/gems/pghero-3.4.1/app/views/pg_hero/home/_queries_table.html.erb (Duration: 34.4ms | Allocations: 25573)
Completed 200 OK in 80ms (Views: 35.0ms | ActiveRecord: 11.4ms | Allocations: 61899)


  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT "users".* FROM "users" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
